# Введение
В рамках курса было необходимо разработать приложение, позволяющее продемонстировать применение основных принципов проектирования программного обеспечения.
В частности, в приложении необходимо было выделить следующие компоненты:

* Слой бизнес-логики
* Слой хранения данных
* Слой представления

Было решено разработать информационную систему для научного журнала.

# Роли
В проекте выделено 3 роли: исследователь, редакция и рецензент:

1. Исследователь
  * Разрабатывает научную тему
  * Пишет статью по ней
  * Принимает замечания по ней
  * Цель: Чтобы его статья была опубликована в журнале

2. Рецензент
  * Выбирается редакцией
  * Получает статьи для просмотра
  * Дает оценку статье (стоит ли принимать для публикации)
  * Высказывает замечания, возникшие при прочтении статьи
  * Цель: Выбрать подходящие статьи
  
3. Редакция
  * Принимает статьи
  * Устанавливает правила принятия статей
  * Подбирает рецензентов
  * Связывает рецензентов и авторов
  * Корректирует статьи, если необходимо
  * Издает журнал с помощью типографии
  * Цель: Принять качественные статьи, заработать на продаже журналов

# Варианты использования

## Написание статьи
1. **Исследователь** выбирает **тему** и при поддержке научного руководителя проводит исследования
2. По результататам исследований автор при поддержке соавторов пишет **научную статью**
3. Автор выбирает **журнал** для публикации
4. Автор получает от редакторов журнала **правила оформления**
5. Автор редактирует статью в соответствии с правилами
  * Альтернатива: Редакция журнала сама готова привести **форматирование** к требуемому виду

## Подача
1. Автор отправляет статью в **систему подачи статей**
2. **Редакция** просматривает статью
3. Статья передается на рецензирование
  * Альтернатива: Редакция отказывает в приеме статьи и отправляет исследователю **список замечаний**, чтобы он их исправил
  * Альтернатива: Редакция отказывает в приеме и рекомендует автору отправить статью в **другой журнал**

## Рецензирование
1. Редакторы подбирают **рецензентов** и отправляют им статью
2. Рецензенты читают статью и составляют **отчет** по ней, содержащий **вопросы**, **замечания** и **общую оценку статьи**
3. Редакторы пересылают вопросы и замечания исследователю
4. В соответствии с оценкой редакция принимает **решение** о публикации
  * Альтернатива: Редакция отказывает в публикации, статья дорабатывается и передается либо на этап рецензирования, либо на этап подачи, либо в другой журнал
  
## Подготовка и публикация
1. Редакция адаптирует статью под **макет журнала**
2. Редакция исправляет **ошибки правописания**
3. Статья помещается в **пул публикаций**, которые будут опубликованы в следующем **выпуске** журнала
  * Альтернатива: В дополнение к журналу, статья может быть **опубликована онлайн** индивидуально. Это происходит сразу же, без ожидания следующего выпуска журнала
4. Журнал из статей отправляется в **типографию**
  * Альтернатива: В дополнение к печатному варианту, журнал может быть опубликован в цифровом варианте

# Диаграмма вариантов использования

![Диаграмма вариантов использования](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/UseCases.png)

# Диаграмма классов
![Диаграмма классов](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/ClassDiagram.png)

# Диаграмма последовательностей

## Написание статьи и отправка в журнал
![Seq1](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/Seq1.png)

## Рецензирование
![Seq2](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/Seq2.png)

# Проектирование слоя бизнес-логики
В качестве архитектурного шаблона был выбран шаблон "Модель предметной области".
В связи с этим, были выделены сущности предметной области и для каждой из сущностей было решено создать отдельный класс, описывающий данную сущность. Написанные классы расположены в пакете objects.

# Реализация слоя бизнес-логики
Для классов слоя бизнес-логики был создан пакет services.

Основной класс бизнес-логики - SubmissionUpdate. Он содержит методы, помогающие "продвигать" статью по цепочке редакция-рецензент-издательство.

# Проектирование слоя хранения данных
Для слоя хранения был выбран паттерн "Преобразователь данных" (Data Mapper), ввиду того, что он хорошо подходит под паттерн "Модель предметной области".
Все классы, связанные с хранением данных, содержатся в пакете storage. Имеются две реализации слоя хранения: на основе коллекций Java (в пакете storage.java) и на основе РСУБД (в пакете storage.mappers). Для абстрагирования сервисов от конкретного слоя использовался набор интерфейсов, соответствующих названию сущности (например, PaperStorage).

# Реализация слоя хранения данных
В качестве СУБД было решено использовать PostgreSQL по причине того, что она уже была установлена и настроена на используемом компьютере. В начале работы над проектом использовалась HyperSQL, однако из-за малой функциональности пришлось отказаться от неё.

Для удобства, в качестве первичного ключа использовались UUID. Генерация ключей происходила на стороне приложения.

# Проектирование тестового набора
Для тестирования использовался фреймворк JUnit 4. Тесты по своей сути повторяют варианты использования.

# Проектирование слоя представления
Было решено разработать Web-интерфейс. В качестве Web-сервера использовался Spark (на основе Jetty 9.3). Для генерации страниц на стороне сервера использовалась библиотека Thymeleaf. Весь код, связанный с интерфейсом пользователя, находится в пакете UI. Основной класс - WebUI.

В проекте имеются 4 HTML-страницы - по одной для каждой роли, плюс index для навигации.

Ниже приведены примеры страниц.

![Researcher](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/ResearcherUI.png)
![Editor](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/EditorUI.png)
![Reviewer](https://raw.githubusercontent.com/h31/SoftwareArchitecture/master/ReviewerUI.png)

## Реализация интеграции со сторонними сервисами
Для реализации сервиса, отвечающего за поиск похожих статей, был создан отдельный класс SimilarPapers.

В качестве источника данных использовался arXiv API. [Пример запроса к API](http://export.arxiv.org/api/query?search_query=cats&start=0&max_results=5).

Для REST-интерфейса со стороны приложения была выбрана функциональность выгрузки готовых к печати статей в журнал. Пример выдачи в формате JSON:
```
[ {
  "state" : "IN_POOL",
  "paper" : {
    "id" : "a6230614-e8c2-4651-8f78-8285e8662626",
    "title" : "Code Uglify",
    "authors" : [ {
      "name" : "Peter",
      "university" : "MIT"
    } ],
    "keywords" : [ ],
    "abstractTxt" : "Abstract",
    "content" : "Text"
  },
  "reviewerRemark" : {
    "reviewer" : {
      "name" : "Rodrigo",
      "university" : "CMU",
      "id" : "0ae4f284-c5e4-4a41-bd4d-04af51974b36"
    },
    "mark" : "ACCEPT",
    "text" : "OK",
    "id" : "d5f7ad31-6bc9-44aa-a65a-f72d114bd068"
  },
  "editorialRemark" : {
    "id" : "4ac37a8a-f82a-4f67-ae9d-24e727e1aa4a",
    "decision" : "ACCEPT",
    "remark" : ""
  },
  "date" : 1465159744865
} ]
```

Пример выдачи в формате XML:
```

<ArrayList>
  <item>
    <state>IN_POOL</state>
    <paper>
      <id>a6230614-e8c2-4651-8f78-8285e8662626</id>
      <title>Code Uglify</title>
      <authors>
        <authors>
          <name>Peter</name>
          <university>MIT</university>
        </authors>
      </authors>
      <keywords/>
      <abstractTxt>Abstract</abstractTxt>
      <content>Text</content>
    </paper>
    <reviewerRemark>
      <reviewer>
        <name>Rodrigo</name>
        <university>CMU</university>
        <id>0ae4f284-c5e4-4a41-bd4d-04af51974b36</id>
      </reviewer>
      <mark>ACCEPT</mark>
      <text>OK</text>
      <id>d5f7ad31-6bc9-44aa-a65a-f72d114bd068</id>
    </reviewerRemark>
    <editorialRemark>
      <id>4ac37a8a-f82a-4f67-ae9d-24e727e1aa4a</id>
      <decision>ACCEPT</decision>
      <remark></remark>
    </editorialRemark>
    <date>1465159744865</date>
  </item>
</ArrayList>
```

# Заключение
В рамках данного курса были изучены принципы разработки архитектуры программного обеспечения, а так же, следуя этим принципам, было разработано приложение.
в приложении было создано три слоя:

* Слой бизнес-логики
* Слой хранения данных
* Слой представления
